WITH RECURSIVE cte(department_id, department_name, department_parent, is_parent, user_id, user_fio, user_inner_phone, status_at, head_of_depatment_id, status_color, status_name, status_id, position) AS 
(SELECT departments.id AS department_id, departments.name AS department_name, departments.parent_department_id AS department_parent, departments.is_parent AS is_parent, users.id AS user_id, users.fio AS user_fio, users.inner_phone AS user_inner_phone, users.status_at AS status_at, head_of_depatments.head_of_depatment_id AS head_of_depatment_id, status_users.color AS status_color, status_users.name AS status_name, status_users.id AS status_id, position.name AS position 
FROM departments LEFT OUTER JOIN users ON users.department_id = departments.id LEFT OUTER JOIN head_of_depatments ON head_of_depatments.head_of_depatment_id = users.id LEFT OUTER JOIN status_users ON status_users.id = users.status_id LEFT OUTER JOIN position ON position.id = users.position_id 
WHERE users.fio ILIKE %(fio_1)s UNION SELECT departments.id AS department_id, departments.name AS department_name, departments.parent_department_id AS department_parent, departments.is_parent AS is_parent, users.id AS user_id, users.fio AS user_fio, users.inner_phone AS user_inner_phone, users.status_at AS status_at, head_of_depatments.head_of_depatment_id AS head_of_depatment_id, status_users.color AS status_color, status_users.name AS status_name, status_users.id AS status_id, position.name AS position 
FROM users, head_of_depatments, status_users, position, departments JOIN cte ON cte.department_parent = departments.id)
 SELECT cte.department_id AS cte_department_id, cte.department_name AS cte_department_name, cte.department_parent AS cte_department_parent, cte.is_parent AS cte_is_parent, cte.user_id AS cte_user_id, cte.user_fio AS cte_user_fio, cte.user_inner_phone AS cte_user_inner_phone, cte.status_at AS cte_status_at, cte.head_of_depatment_id AS cte_head_of_depatment_id, cte.status_color AS cte_status_color, cte.status_name AS cte_status_name, cte.status_id AS cte_status_id, cte.position AS cte_position 
FROM cte